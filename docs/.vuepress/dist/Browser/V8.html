<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>V8垃圾回收机制 | 前端打杂师 - Zhu</title>
    <meta name="description" content="All is well">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/vue-press/image/favicon.ico">
    
    <link rel="preload" href="/vue-press/assets/css/0.styles.309fb19c.css" as="style"><link rel="preload" href="/vue-press/assets/js/app.da7e946b.js" as="script"><link rel="preload" href="/vue-press/assets/js/2.0f3728a8.js" as="script"><link rel="preload" href="/vue-press/assets/js/8.d493bee3.js" as="script"><link rel="prefetch" href="/vue-press/assets/js/10.7d8caf48.js"><link rel="prefetch" href="/vue-press/assets/js/11.6067b55f.js"><link rel="prefetch" href="/vue-press/assets/js/12.fdebb669.js"><link rel="prefetch" href="/vue-press/assets/js/13.773aacde.js"><link rel="prefetch" href="/vue-press/assets/js/14.e95879dd.js"><link rel="prefetch" href="/vue-press/assets/js/15.5d6134b0.js"><link rel="prefetch" href="/vue-press/assets/js/16.d3b871a5.js"><link rel="prefetch" href="/vue-press/assets/js/17.8f51b858.js"><link rel="prefetch" href="/vue-press/assets/js/18.f1e79026.js"><link rel="prefetch" href="/vue-press/assets/js/19.3468003f.js"><link rel="prefetch" href="/vue-press/assets/js/20.a60496f0.js"><link rel="prefetch" href="/vue-press/assets/js/21.1cc1b4af.js"><link rel="prefetch" href="/vue-press/assets/js/3.429d08a1.js"><link rel="prefetch" href="/vue-press/assets/js/4.ad33241c.js"><link rel="prefetch" href="/vue-press/assets/js/5.8803b9cf.js"><link rel="prefetch" href="/vue-press/assets/js/6.985bcf73.js"><link rel="prefetch" href="/vue-press/assets/js/7.0b1339da.js"><link rel="prefetch" href="/vue-press/assets/js/9.0b2732c6.js">
    <link rel="stylesheet" href="/vue-press/assets/css/0.styles.309fb19c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vue-press/" class="home-link router-link-active"><!----> <span class="site-name">前端打杂师 - Zhu</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vue-press/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/vue-press/JS/Base.html" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="https://github.com/ThecoadeR/vue-press/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vue-press/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/vue-press/JS/Base.html" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="https://github.com/ThecoadeR/vue-press/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>VuePress</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Electron</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>浏览器相关</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue-press/Browser/" class="sidebar-link">浏览器相关机制</a></li><li><a href="/vue-press/Browser/V8.html" class="active sidebar-link">V8垃圾回收机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-press/Browser/V8.html#开始前的名词解释环节" class="sidebar-link">开始前的名词解释环节</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端代码规范</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端面试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>随手记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="v8垃圾回收机制"><a href="#v8垃圾回收机制" class="header-anchor">#</a> V8垃圾回收机制</h1> <h2 id="开始前的名词解释环节"><a href="#开始前的名词解释环节" class="header-anchor">#</a> 开始前的名词解释环节</h2> <h3 id="代际假说和分代收集"><a href="#代际假说和分代收集" class="header-anchor">#</a> 代际假说和分代收集</h3> <ul><li><p>首先明确一点 <code>代际假说</code>是一个非常关键的概念 它是垃圾回收策略的相关基础</p></li> <li><p><code>代际假说</code>有两个特点</p> <ul><li><ol><li>大部分对象在内存中的存活时间非常短 简单来说就是 对象一经内存分配 很快就会无法访问</li></ol></li> <li><ol start="2"><li>可以持续访问的对象(不死的对象) 存活时间较长</li></ol></li></ul></li></ul> <p>口头描述是不是感觉比较生涩难以理解 但是没关系 我们先记住这两个特点 并且我们基于这两个特点 来一起看看 V8是如何实现垃圾回收机制的</p> <ul><li><p><code>新生代</code> 和 <code>老生代</code></p> <ul><li><ol><li>新生代 用于存放在内存中存活时间比较短的对象</li></ol></li> <li><ol start="2"><li>老生代 用于存放在内存中存活时间比较长的对象</li></ol></li> <li><ol start="3"><li>同时 V8基于<code>新生代</code> 对应一个<code>副垃圾回收器</code> 而<code>老生代</code>对应一个<code>主垃圾回收器</code></li></ol></li></ul></li> <li><p>垃圾回收的执行流程</p> <ul><li><p>不论主垃圾回收器还是副垃圾回收器 他们都有一个<code>统一的执行过程</code></p></li> <li><ol><li>标记<code>活动对象</code>和<code>非活动对象</code>  前者的名词解释其实就是 <code>还在使用的对象</code> 后者的名词解释就是 <code>可以进行垃圾回收的对象</code></li></ol></li> <li><ol start="2"><li>对于<code>非活动对象</code>所占据对内存 进行一次回收 (垃圾清理)</li></ol></li> <li><ol start="3"><li>内存整理 我们都知道内存是一块<code>连续的分配空间</code> 当多次进行垃圾回收以后 这块连续的内存空间会被变得不连续 那么就会产生<code>内存碎片</code> 不过这一步并不是必须的 同时在上文提到的<code>副垃圾回收器</code>并不会产生内存碎片</li></ol></li></ul></li> <li><p>有了上述的名词解释基础以后 我们一起来看看副垃圾回收器是如何工作的吧</p></li></ul> <h3 id="副垃圾回收器工作流-scavenge算法"><a href="#副垃圾回收器工作流-scavenge算法" class="header-anchor">#</a> 副垃圾回收器工作流(scavenge算法)</h3> <ul><li><p>基于<code>scavenge算法</code> 副垃圾回收器把新生区对半分为了 <code>对象空间</code>和<code>空闲空间</code> 而所有的新对象都会被添加到<code>对象空间</code>里 同时 当对象空间快被<code>填满</code>的时候就会触发垃圾回收的前置条件</p></li> <li><h3 id="回收过程"><a href="#回收过程" class="header-anchor">#</a> 回收过程</h3> <ul><li><ol><li>标记活动对象和非活动对象</li></ol></li> <li><ol start="2"><li><code>活动对象</code>复制到空闲区域中 同时<code>有序排列</code>所有的存活对象 这里的有序排列正好解释了为什么副垃圾回收器不会产生<code>内存碎片</code><br>
(<code>一块连续的内存空间被分割以后就会产生内存碎片 而副垃圾回收器在复制完活动对象以后 对所有的对象进行了一次排序 那么内存会重新归于连续状态</code>)</li></ol></li> <li><ol start="3"><li>对<code>空闲区域</code>和<code>对象区域</code>做一次角色翻转 也就是两者角色兑换 也正是因为这个机制 在新生区中 这两个区域可以<code>无限次使用</code> 脑补一下翻转过程 翻转以后此时的<code>空闲区域</code>被<code>非活动对象填充</code> <code>对象区域</code>仅剩下<code>活动对象</code> 所以 也就完成了垃圾回收</li></ol></li> <li><ol start="4"><li>翻转以后即完成垃圾回收</li></ol></li></ul> <p>具体的回收过程 可以参考下图
<img src="/vue-press/assets/img/scavenge.a746b22e.jpeg" alt="副垃圾器回收流程"></p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue-press/Browser/" class="prev router-link-active">
        浏览器相关机制
      </a></span> <span class="next"><a href="/vue-press/CheckList/">
        前端代码规范
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vue-press/assets/js/app.da7e946b.js" defer></script><script src="/vue-press/assets/js/2.0f3728a8.js" defer></script><script src="/vue-press/assets/js/8.d493bee3.js" defer></script>
  </body>
</html>
